# -*- coding: utf-8 -*-
"""ik_agent.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1kD6SmAzFSEOYc66lIxnJomHb2Ed2HRyE
"""

!pip install groq

import re
import math
from collections import Counter
from google.colab import userdata
from groq import Groq

# ======================================================
# 1. API KURULUMU (GROQ)
# ======================================================
# Colab'in solundaki 'Secrets' (Anahtar ikonu) kÄ±smÄ±na
# GROQ_API_KEY adÄ±yla anahtarÄ±nÄ± eklemeyi unutma.
try:
    groq_api_key = userdata.get('GROQ_API_KEY')
    client = Groq(api_key=groq_api_key)
except Exception as e:
    print("UYARI: GROQ_API_KEY bulunamadÄ±. LÃ¼tfen Colab Secrets kÄ±smÄ±na ekleyin.")

# ======================================================
# 2. RAG MOTORU (Senin Kodundaki SimpleRAG SÄ±nÄ±fÄ±)
# ======================================================
class SimpleRAG:
    def __init__(self):
        self.vector_store = []

    def get_embedding(self, text):
        # Basit kelime sayma (Bag of Words) vektÃ¶rÃ¼
        words = re.findall(r'\w+', text.lower())
        return Counter(words)

    def _cosine_similarity(self, vec1, vec2):
        intersection = set(vec1.keys()) & set(vec2.keys())
        numerator = sum([vec1[x] * vec2[x] for x in intersection])
        sum1 = sum([vec1[x]**2 for x in vec1.keys()])
        sum2 = sum([vec2[x]**2 for x in vec2.keys()])
        denominator = math.sqrt(sum1) * math.sqrt(sum2)
        return float(numerator) / denominator if denominator else 0.0

    def ingest(self, text):
        # Metni cÃ¼mle/paragraf bazlÄ± bÃ¶lme
        chunks = [s.strip() for s in text.split('\n') if s.strip()]
        for chunk in chunks:
            self.vector_store.append({
                "content": chunk,
                "vector": self.get_embedding(chunk)
            })

    def retrieve(self, query, top_k=3):
        query_vec = self.get_embedding(query)
        scores = []
        for item in self.vector_store:
            score = self._cosine_similarity(query_vec, item["vector"])
            scores.append((score, item["content"]))
        scores.sort(key=lambda x: x[0], reverse=True)
        # Sadece alakalÄ± sonuÃ§larÄ± dÃ¶ndÃ¼r
        return "\n".join([item[1] for item in scores[:top_k] if item[0] > 0.1])

# --- VERÄ° SETÄ°NÄ° YÃœKLÃœYORUZ (DATASET) ---
rag_engine = SimpleRAG()

def load_data_from_json():
    with open('sirket_politikalari.json', 'r', encoding='utf-8') as f:
        data = json.load(f)
    # BaÅŸlÄ±k ve iÃ§eriÄŸi birleÅŸtirip tek metin haline getiriyoruz
    full_text = "\n\n".join([f"{item['baslik']}:\n{item['icerik']}" for item in data])
    return full_text

# Veriyi yÃ¼kle ve RAG motoruna ver
dataset_text = load_data_from_json()
rag_engine = SimpleRAG()
rag_engine.ingest(dataset_text)

rag_engine.ingest(hr_policy_text)

# ======================================================
# 3. ARAÃ‡LAR (TOOLS)
# ======================================================

def calculator(expression: str) -> str:
    """
    Matematiksel iÅŸlemleri yapar. Ã–rn: 14 + 5 veya 300 * 20
    """
    try:
        # GÃ¼venlik iÃ§in sadece belirli karakterlere izin ver
        allowed_chars = set("0123456789+-*/(). ")
        if not all(c in allowed_chars for c in expression):
            return "Hata: GeÃ§ersiz karakter."
        return str(eval(expression))
    except Exception as e:
        return f"Hata: {e}"

def hr_policy_search(query: str) -> str:
    """
    Åirket politikalarÄ±, izinler, maaÅŸ ve kurallar hakkÄ±nda bilgi arar.
    Ã–rn: hr_policy_search: evlilik izni kaÃ§ gÃ¼n
    """
    print(f"\nğŸ” [RAG MODÃœLÃœ] VeritabanÄ± taranÄ±yor: '{query}'")
    result = rag_engine.retrieve(query)
    if not result:
        return "Politika dÃ¶kÃ¼manlarÄ±nda bu konuda bilgi bulunamadÄ±."
    return f"DÃ¶kÃ¼man SonuÃ§larÄ±:\n{result}"

# AraÃ§ Listesi
tools = [calculator, hr_policy_search]
tools_with_desc = "\n\n".join([tool.__name__ + tool.__doc__ for tool in tools])
known_actions = dict([(tool.__name__, tool) for tool in tools])

# ======================================================
# 4. AGENT VE PROMPT (BEYÄ°N)
# ======================================================

system_prompt = f"""
Sen ÅŸirketin Ä°nsan KaynaklarÄ± (Ä°K) asistanÄ±sÄ±n.
DÃ¼ÅŸÃ¼n (Thought), Aksiyon (Action), Dur (PAUSE) ve GÃ¶zlem (Observation) dÃ¶ngÃ¼sÃ¼yle Ã§alÄ±ÅŸÄ±rsÄ±n.

KURALLAR:
1. Åirket kurallarÄ±, izinler ve maaÅŸlar iÃ§in MUTLAKA 'hr_policy_search' aracÄ±nÄ± kullan. Ezbere cevap verme.
2. SayÄ±sal hesaplamalar (maaÅŸ toplamÄ±, gÃ¼n sayÄ±sÄ± vb.) iÃ§in 'calculator' kullan.
3. Her zaman TÃ¼rkÃ§e dÃ¼ÅŸÃ¼n ve TÃ¼rkÃ§e cevap ver.

KullanabileceÄŸin AraÃ§lar:
{tools_with_desc}

Ã–rnek AkÄ±ÅŸ:
Soru: Evlenirsem kaÃ§ gÃ¼n iznim olur ve bu yÄ±llÄ±k izinden dÃ¼ÅŸer mi?
Thought: Evlilik izni kuralÄ±nÄ± Ã¶ÄŸrenmek iÃ§in politika aramasÄ± yapmalÄ±yÄ±m.
Action: hr_policy_search: evlilik izni
PAUSE
Observation: Evlenen Ã§alÄ±ÅŸana 3 gÃ¼n Ã¼cretli izin verilir, yÄ±llÄ±k izinden dÃ¼ÅŸÃ¼lmez.
Answer: Evlilik durumunda 3 gÃ¼n Ã¼cretli izniniz olur ve bu sÃ¼re yÄ±llÄ±k izninizden dÃ¼ÅŸÃ¼lmez.
""".strip()

class Agent:
    def __init__(self, system=""):
        self.system = system
        self.messages = []
        if self.system:
            self.messages.append({"role": "system", "content": system})

    def __call__(self, message):
        self.messages.append({"role": "user", "content": message})
        result = self.execute()
        self.messages.append({"role": "assistant", "content": result})
        return result

    def execute(self):
        completion = client.chat.completions.create(
            model="llama-3.3-70b-versatile", # Groq Ã¼zerindeki gÃ¼Ã§lÃ¼ model
            messages=self.messages,
            temperature=0,
            stop=["PAUSE", "Observation:", "<|"]
        )
        return completion.choices[0].message.content

# ======================================================
# 5. Ã‡ALIÅTIRMA DÃ–NGÃœSÃœ (MAIN LOOP)
# ======================================================

action_re = re.compile(r'^Action: (\w+): (.*)$')

def query(question, max_turns=5):
    i = 0
    bot = Agent(system_prompt)
    next_prompt = question
    print(f"\n{'='*40}\nSORU: {question}\n{'='*40}")

    while i < max_turns:
        i += 1
        result = bot(next_prompt)
        print(f"\033[94m{result}\033[0m") # Mavi renkli Ã§Ä±ktÄ±

        # Action var mÄ± kontrol et
        actions = [action_re.match(a) for a in result.split('\n') if action_re.match(a)]

        if actions:
            action, action_input = actions[0].groups()
            if action not in known_actions:
                print(f"Hata: Bilinmeyen aksiyon -> {action}")
                return

            print(f"=> Ã‡alÄ±ÅŸtÄ±rÄ±lÄ±yor: {action} ({action_input})")

            # Tool'u Ã§alÄ±ÅŸtÄ±r
            observation = known_actions[action](action_input)
            print(f"Observation: {observation}")

            # Sonucu ajana geri besle
            next_prompt = f"Observation: {observation}"
        else:
            # Action yoksa cevap bitmiÅŸtir
            return

# ======================================================
# 6. GELÄ°ÅMÄ°Å TEST SENARYOLARI (BENCHMARK)
# ======================================================

print("\n--- SENARYO 1: TEMEL RAG (RETRIEVAL) ---")
# AmaÃ§: Basit bilgi Ã§ekme yeteneÄŸini gÃ¶sterir[cite: 31].
query("Cuma gÃ¼nÃ¼ ofise ÅŸortla gelebilir miyim?")


print("\n--- SENARYO 2: KARMAÅIK MATEMATÄ°K (MATH + LOGIC) ---")
# AmaÃ§: AjanÄ±n formÃ¼lÃ¼ bulup (MaaÅŸ/12 * KatsayÄ±) hesaplama yapmasÄ±nÄ± test eder[cite: 34, 35].
# Veri Setindeki Bilgi: Notu 5 olanÄ±n katsayÄ±sÄ± 2.5'tir.
query("YÄ±llÄ±k brÃ¼t maaÅŸÄ±m 600.000 TL ve performans notum 5 (MÃ¼kemmel). YÄ±l sonu primim tam olarak ne kadar yatar?")


print("\n--- SENARYO 3: Ã‡OKLU PARA BÄ°RÄ°MÄ° VE TOPLAMA (MULTI-HOP) ---")
# AmaÃ§: FarklÄ± maddelerdeki (Avrupa ve Asya) harcÄ±rahlarÄ± bulup toplamasÄ±nÄ± test eder[cite: 34].
# Veri Setindeki Bilgi: Avrupa 130 Euro, Asya 110 USD.
query("Gelecek ay iÅŸ iÃ§in 3 gÃ¼n Paris'e (Avrupa), sonra 2 gÃ¼n Tokyo'ya (Asya) gideceÄŸim. Toplam harcÄ±rahÄ±m ne kadar tutar?")


print("\n--- SENARYO 4: KOÅULLU MANTIK VE Ä°STÄ°SNA (EDGE CASE) ---")
# AmaÃ§: KuralÄ±n istisnasÄ±nÄ± (Deneme sÃ¼resi) yakalayÄ±p yakalamadÄ±ÄŸÄ±nÄ± test eder[cite: 5].
# Veri Setindeki Bilgi: Ä°lk 2 ay (deneme sÃ¼resi) uzaktan Ã§alÄ±ÅŸma yasaktÄ±r.
query("Ä°ÅŸe dÃ¼n baÅŸladÄ±m (henÃ¼z 1. ayÄ±mdayÄ±m), haftada 3 gÃ¼n evden Ã§alÄ±ÅŸabilir miyim?")


print("\n--- SENARYO 5: ETÄ°K VE SINIR DEÄER TESTÄ° (POLICY CHECK) ---")
# AmaÃ§: SayÄ±sal sÄ±nÄ±r kontrolÃ¼ (50 USD) testi.
query("Bir tedarikÃ§i bana 100 Dolar deÄŸerinde bir hediye gÃ¶nderdi, bunu kabul etmemde sakÄ±nca var mÄ±?")

import json

# ==========================================
# PROFESYONEL VE KAPSAMLI Ä°K VERÄ° SETÄ° (V2 - GENÄ°ÅLETÄ°LMÄ°Å)
# ==========================================

dataset = [
    # --- 1. MESAÄ° VE Ã‡ALIÅMA DÃœZENÄ° ---
    {
        "baslik": "Standart Ã‡alÄ±ÅŸma Saatleri",
        "icerik": "Åirket genelinde mesai saatleri 08:30 - 17:30 arasÄ±ndadÄ±r. Ã–ÄŸle molasÄ± 12:00-13:30 arasÄ±nda 1.5 saattir. Cuma gÃ¼nleri 'Happy Hour' uygulamasÄ± nedeniyle mesai 16:00'da sona erer."
    },
    {
        "baslik": "Fazla Mesai (Overtime) Ãœcretleri",
        "icerik": "HaftalÄ±k 45 saati aÅŸan Ã§alÄ±ÅŸmalar fazla mesai sayÄ±lÄ±r. Hafta iÃ§i yapÄ±lan fazla mesailer saatlik Ã¼cretin 1.5 katÄ±, hafta sonu ve resmi tatillerde yapÄ±lan Ã§alÄ±ÅŸmalar ise saatlik Ã¼cretin 2.0 katÄ± olarak Ã¶denir. YÃ¶neticiler (Manager ve Ã¼stÃ¼) fazla mesai Ã¼creti almaz."
    },
    {
        "baslik": "Uzaktan Ã‡alÄ±ÅŸma (Remote) KurallarÄ±",
        "icerik": "Tam zamanlÄ± Ã§alÄ±ÅŸanlar haftada en fazla 3 gÃ¼n evden Ã§alÄ±ÅŸabilir. Ancak Pazartesi ve PerÅŸembe gÃ¼nleri tÃ¼m ekiplerin ofiste olmasÄ± zorunludur. Deneme sÃ¼resindeki (ilk 2 ay) personelin uzaktan Ã§alÄ±ÅŸma hakkÄ± yoktur."
    },
    {
        "baslik": "Stajyer Ã‡alÄ±ÅŸma DÃ¼zeni",
        "icerik": "Stajyerler haftada en az 3 gÃ¼n ofise gelmek zorundadÄ±r. Stajyerlerin uzaktan Ã§alÄ±ÅŸma (remote) hakkÄ± bulunmamaktadÄ±r. Stajyer mesaisi 09:00-18:00 arasÄ±ndadÄ±r."
    },
    {
        "baslik": "Gece VardiyasÄ± TazminatÄ±",
        "icerik": "AkÅŸam 20:00 ile sabah 06:00 arasÄ±ndaki Ã§alÄ±ÅŸmalar 'Gece Ã‡alÄ±ÅŸmasÄ±' kabul edilir. Bu saatlerde Ã§alÄ±ÅŸan personele %30 ek vardiya tazminatÄ± Ã¶denir ve ÅŸirket tarafÄ±ndan eve dÃ¶nÃ¼ÅŸ taksi Ã¼creti (Uber/BiTaksi fiÅŸi ile) karÅŸÄ±lanÄ±r."
    },

    # --- 2. MAAÅ, PRÄ°M VE FÄ°NANSAL HAKLAR ---
    {
        "baslik": "MaaÅŸ Ã–deme ve Avans",
        "icerik": "MaaÅŸlar her ayÄ±n 1'inde ilgili banka hesabÄ±na yatar. AyÄ±n 1'i tatile gelirse takip eden ilk iÅŸ gÃ¼nÃ¼ Ã¶deme yapÄ±lÄ±r. AyÄ±n 15'inde maaÅŸÄ±n %30'una kadar avans talep edilebilir."
    },
    {
        "baslik": "YÄ±l Sonu Performans Primi",
        "icerik": "YÄ±llÄ±k prim hesaplamasÄ± ÅŸÃ¶yledir: (YÄ±llÄ±k BrÃ¼t MaaÅŸ / 12) * (Performans KatsayÄ±sÄ±). KatsayÄ±lar: Performans notu 5 (MÃ¼kemmel) iÃ§in 2.5 maaÅŸ, 4 (Ä°yi) iÃ§in 1.5 maaÅŸ, 3 (Orta) iÃ§in 0.5 maaÅŸ. Notu 3'Ã¼n altÄ±nda olanlara prim Ã¶denmez."
    },
    {
        "baslik": "Hisse Senedi OpsiyonlarÄ± (ESOP)",
        "icerik": "Senior ve Ã¼zeri Ã§alÄ±ÅŸanlara ÅŸirket hisse opsiyonu verilir. Hak ediÅŸ (Vesting) sÃ¼resi 4 yÄ±ldÄ±r. Ä°lk yÄ±lÄ±n sonunda %25'i hak edilir (Cliff), kalan %75 sonraki 3 yÄ±lda aylÄ±k eÅŸit taksitlerle hak edilir."
    },
    {
        "baslik": "YabancÄ± Dil TazminatÄ±",
        "icerik": "Ä°ngilizce seviyesini belgeleyen (TOEFL 90+ veya IELTS 7.0+) personele aylÄ±k net 4.000 TL, Almanca veya FransÄ±zca iÃ§in (B2+) aylÄ±k net 3.000 TL dil tazminatÄ± Ã¶denir. Tazminat en fazla 2 dil iÃ§in geÃ§erlidir."
    },
    {
        "baslik": "KÄ±dem TeÅŸvik Bonusu",
        "icerik": "Åirkette 5. yÄ±lÄ±nÄ± dolduranlara tek seferlik 50.000 TL, 10. yÄ±lÄ±nÄ± dolduranlara ise tek seferlik 100.000 TL sadakat bonusu Ã¶denir."
    },

    # --- 3. YEMEK, YOL VE YAN HAKLAR ---
    {
        "baslik": "Yemek KartÄ± UygulamasÄ±",
        "icerik": "GÃ¼nlÃ¼k yemek Ã¼creti net 380 TL'dir. Bu tutar ay baÅŸÄ±nda Sodexo veya Ticket kartÄ±na, o ayki iÅŸ gÃ¼nÃ¼ sayÄ±sÄ± kadar yÃ¼klenir. Raporlu veya izinli olunan gÃ¼nler iÃ§in yemek Ã¼creti yatÄ±rÄ±lmaz."
    },
    {
        "baslik": "Yol YardÄ±mÄ± ve Servis",
        "icerik": "Åirket servisini kullanmayan personele ikamet mesafesine gÃ¶re yol yardÄ±mÄ± yapÄ±lÄ±r. 0-15 km arasÄ±: AylÄ±k 1.500 TL. 15-30 km arasÄ±: AylÄ±k 2.500 TL. 30 km Ã¼zeri: AylÄ±k 3.500 TL net Ã¶deme yapÄ±lÄ±r."
    },
    {
        "baslik": "Ã–zel SaÄŸlÄ±k SigortasÄ± (Ã–SS)",
        "icerik": "TÃ¼m Ã§alÄ±ÅŸanlara 'Standart Yatarak Tedavi' sigortasÄ± yapÄ±lÄ±r. Ä°steyen Ã§alÄ±ÅŸan maaÅŸÄ±ndan aylÄ±k 1.200 TL kesinti yapÄ±larak 'KapsamlÄ± Ayakta + Yatarak' paketine geÃ§ebilir. EÅŸ ve Ã§ocuk ekletmek kiÅŸi baÅŸÄ± aylÄ±k 800 TL'dir."
    },
    {
        "baslik": "Ä°nternet ve Fatura DesteÄŸi",
        "icerik": "Uzaktan Ã§alÄ±ÅŸma modeline dahil olan personele aylÄ±k 750 TL iletiÅŸim ve internet faturasÄ± desteÄŸi bordroya yansÄ±tÄ±larak Ã¶denir."
    },
    {
        "baslik": "KreÅŸ ve Ã‡ocuk YardÄ±mÄ±",
        "icerik": "0-6 yaÅŸ arasÄ± Ã§ocuÄŸu olan kadÄ±n Ã§alÄ±ÅŸanlara ve eÅŸi Ã§alÄ±ÅŸmayan erkek Ã§alÄ±ÅŸanlara, Ã§ocuk baÅŸÄ±na aylÄ±k net 3.000 TL kreÅŸ yardÄ±mÄ± Ã¶denir. Bu yardÄ±m en fazla 2 Ã§ocuk iÃ§in geÃ§erlidir."
    },
    {
        "baslik": "Spor ve Ä°yi YaÅŸam DesteÄŸi",
        "icerik": "Spor salonu Ã¼yeliÄŸi faturasÄ±nÄ± ibraz eden Ã§alÄ±ÅŸanlara aylÄ±k 600 TL'ye kadar 'Wellbeing' Ã¶demesi yapÄ±lÄ±r. Sigara kullanmayan personele yÄ±lda bir kez 2.000 TL 'SaÄŸlÄ±klÄ± YaÅŸam Bonusu' verilir."
    },

    # --- 4. Ä°ZÄ°NLER VE TATÄ°LLER ---
    {
        "baslik": "YÄ±llÄ±k Ä°zin SÃ¼releri",
        "icerik": "KÄ±demi 1-5 yÄ±l olanlar: 14 iÅŸ gÃ¼nÃ¼. KÄ±demi 5-15 yÄ±l olanlar: 20 iÅŸ gÃ¼nÃ¼. KÄ±demi 15 yÄ±ldan fazla olanlar: 26 iÅŸ gÃ¼nÃ¼. 50 yaÅŸ Ã¼stÃ¼ Ã§alÄ±ÅŸanlar kÄ±demi ne olursa olsun en az 20 gÃ¼n izin hakkÄ±na sahiptir."
    },
    {
        "baslik": "Mazeret Ä°zinleri",
        "icerik": "Evlilik Ä°zni: 3 gÃ¼n. BabalÄ±k Ä°zni: 5 gÃ¼n. Ã–lÃ¼m Ä°zni (1. derece yakÄ±n): 3 gÃ¼n. TaÅŸÄ±nma Ä°zni: YÄ±lda 1 gÃ¼n. Regl Ä°zni: KadÄ±n Ã§alÄ±ÅŸanlar ayda 1 gÃ¼n Ã¼cretli izin kullanabilir."
    },
    {
        "baslik": "DoÄŸum GÃ¼nÃ¼ Ä°zni",
        "icerik": "Ã‡alÄ±ÅŸanlar, doÄŸum gÃ¼nlerinin olduÄŸu hafta iÃ§erisinde diledikleri 1 gÃ¼n Ã¼cretli izin kullanabilirler."
    },
    {
        "baslik": "Sabbatical (Uzun SÃ¼reli AyrÄ±lÄ±k)",
        "icerik": "Åirkette kesintisiz 7 yÄ±l Ã§alÄ±ÅŸan personel, kariyer molasÄ± (Sabbatical) hakkÄ± kazanÄ±r. Bu kapsamda 3 ay boyunca maaÅŸÄ±nÄ±n %50'sini alarak Ã¼cretli izin yapabilir."
    },

    # --- 5. Ä°Å SEYAHATÄ° VE HARCIRAH ---
    {
        "baslik": "Yurt Ä°Ã§i HarcÄ±rah",
        "icerik": "Åehir dÄ±ÅŸÄ± gÃ¶revlendirmelerde konaklama ve ulaÅŸÄ±m ÅŸirkete aittir. Ek olarak Ã§alÄ±ÅŸana gÃ¼nlÃ¼k 1.000 TL net cep harÃ§lÄ±ÄŸÄ± (harcÄ±rah) verilir."
    },
    {
        "baslik": "Yurt DÄ±ÅŸÄ± HarcÄ±rah (DÃ¶viz)",
        "icerik": "Yurt dÄ±ÅŸÄ± gÃ¶revlerde gÃ¼nlÃ¼k harcÄ±rah bÃ¶lgeye gÃ¶re deÄŸiÅŸir. Avrupa BirliÄŸi Ã¼lkeleri: GÃ¼nlÃ¼k 130 Euro. Amerika ve Kanada: GÃ¼nlÃ¼k 160 USD. Orta DoÄŸu ve Asya: GÃ¼nlÃ¼k 110 USD."
    },
    {
        "baslik": "Temsil ve AÄŸÄ±rlama BÃ¼tÃ§esi",
        "icerik": "MÃ¼ÅŸteri yemeklerinde kiÅŸi baÅŸÄ± harcama limiti 2.000 TL'dir. Alkol harcamalarÄ± ÅŸirket tarafÄ±ndan karÅŸÄ±lanmaz. Ekip yemeklerinde kiÅŸi baÅŸÄ± limit 1.200 TL'dir."
    },
    {
        "baslik": "Kendi AracÄ±nÄ± Kullanma",
        "icerik": "Åirket iÅŸi iÃ§in ÅŸahsi aracÄ±nÄ± kullanan personele km baÅŸÄ±na 12 TL yakÄ±t desteÄŸi Ã¶denir. AylÄ±k maksimum 2.000 km Ã¶deme yapÄ±labilir."
    },

    # --- 6. Ä°ÅE ALIM VE REFERANS ---
    {
        "baslik": "Referans Bonusu Sistemi",
        "icerik": "Mevcut Ã§alÄ±ÅŸanlarÄ±n Ã¶nerdiÄŸi aday iÅŸe alÄ±nÄ±rsa bonus Ã¶denir. Junior Pozisyon: 7.000 TL. Specialist/Mid Pozisyon: 15.000 TL. Senior/Lead Pozisyon: 25.000 TL. YÃ¶netici/Manager: 40.000 TL. Ã–deme, aday deneme sÃ¼resini geÃ§ince yapÄ±lÄ±r."
    },
    {
        "baslik": "TaÅŸÄ±nma (Relocation) DesteÄŸi",
        "icerik": "Åirket talebiyle baÅŸka bir ÅŸehre taÅŸÄ±nan personele 1 maaÅŸ tutarÄ±nda taÅŸÄ±nma ikramiyesi ve nakliye masraflarÄ± (maksimum 30.000 TL) Ã¶denir."
    },

    # --- 7. EÄÄ°TÄ°M VE CÄ°HAZ ---
    {
        "baslik": "EÄŸitim BÃ¼tÃ§esi ve Geri Ã–deme",
        "icerik": "Her Ã§alÄ±ÅŸanÄ±n yÄ±llÄ±k 25.000 TL kiÅŸisel eÄŸitim bÃ¼tÃ§esi vardÄ±r. Ancak, ÅŸirket tarafÄ±ndan karÅŸÄ±lanan eÄŸitimden sonra 6 ay iÃ§inde istifa eden Ã§alÄ±ÅŸan, eÄŸitim Ã¼cretinin tamamÄ±nÄ± (%100) geri Ã¶der."
    },
    {
        "baslik": "Cihaz PolitikasÄ± ve BYOD",
        "icerik": "Ã‡alÄ±ÅŸanlara MacBook Pro veya Dell XPS verilir. Kendi bilgisayarÄ±nÄ± kullanmak isteyen (BYOD) personele aylÄ±k 2.000 TL donanÄ±m kullanÄ±m bedeli Ã¶denir."
    },

    # --- 8. ETÄ°K VE GÃœVENLÄ°K ---
    {
        "baslik": "Hediye Kabul PolitikasÄ±",
        "icerik": "Ã‡alÄ±ÅŸanlar, tedarikÃ§i veya mÃ¼ÅŸterilerden piyasa deÄŸeri 50 USD (veya karÅŸÄ±lÄ±ÄŸÄ± TL) Ã¼zerindeki hediyeleri kabul edemez. Bu tutarÄ±n altÄ±ndaki hediyeler Ä°K'ya bildirilmelidir."
    },
    {
        "baslik": "Ek Ä°ÅŸ ve Ã‡Ä±kar Ã‡atÄ±ÅŸmasÄ±",
        "icerik": "Tam zamanlÄ± Ã§alÄ±ÅŸanlarÄ±n ÅŸirketten onay almadan baÅŸka bir iÅŸte (Freelance dahil) Ã§alÄ±ÅŸmasÄ± yasaktÄ±r. Rakip firmalarla iÅŸ yapmak kesinlikle yasaktÄ±r ve iÅŸten Ã§Ä±karma sebebidir."
    },
    {
        "baslik": "KÄ±yafet ve Ofis DÃ¼zeni",
        "icerik": "Pazartesi-PerÅŸembe arasÄ± 'Smart Casual' giyim zorunludur. Cuma gÃ¼nleri serbest kÄ±yafettir ancak ÅŸort, terlik ve siyasi iÃ§erikli tiÅŸÃ¶rt yasaktÄ±r."
    },
    {
        "baslik": "Temiz Masa Ä°lkesi",
        "icerik": "Mesai bitiminde masalarda gizli veya ÅŸirket iÃ§i (Internal) ibareli hiÃ§bir dÃ¶kÃ¼man bÄ±rakÄ±lmamalÄ±dÄ±r. Ä°hlal durumunda ilk seferde uyarÄ±, tekrarÄ±nda disiplin cezasÄ± uygulanÄ±r."
    },

     # --- 9. Ä°ÅTEN AYRILMA ---
    {
        "baslik": "Ä°hbar SÃ¼releri",
        "icerik": "Ä°stifa veya iÅŸten Ã§Ä±karma durumunda ihbar sÃ¼releri ÅŸÃ¶yledir: 6 aya kadar Ã§alÄ±ÅŸma iÃ§in 2 hafta, 6 ay-1.5 yÄ±l arasÄ± iÃ§in 4 hafta, 1.5-3 yÄ±l arasÄ± iÃ§in 6 hafta, 3 yÄ±ldan fazla Ã§alÄ±ÅŸma iÃ§in 8 hafta."
    }
]

# DosyayÄ± JSON formatÄ±nda kaydetme
with open('sirket_politikalari.json', 'w', encoding='utf-8') as f:
    json.dump(dataset, f, ensure_ascii=False, indent=4)

print(f"âœ… DEV DATASET (V2) HAZIR: Toplam {len(dataset)} adet detaylÄ± madde 'sirket_politikalari.json' dosyasÄ±na kaydedildi.")

# ======================================================
# DATASETÄ° YENÄ°LEME VE RAG MOTORUNA YÃœKLEME
# ======================================================

# 1. Mevcut motoru sÄ±fÄ±rla
rag_engine = SimpleRAG()

# 2. Yeni JSON dosyasÄ±nÄ± oku
try:
    with open('sirket_politikalari.json', 'r', encoding='utf-8') as f:
        new_data = json.load(f)

    # 3. Veriyi metne Ã§evirip birleÅŸtir
    # (BaÅŸlÄ±k ve Ä°Ã§eriÄŸi birleÅŸtiriyoruz ki ajan konuyu anlasÄ±n)
    full_text_data = "\n\n".join([f"POLÄ°TÄ°KA BAÅLIÄI: {item['baslik']}\nKURAL: {item['icerik']}" for item in new_data])

    # 4. RAG Motoruna yÃ¼kle (Ingest)
    rag_engine.ingest(full_text_data)

    print(f"âœ… BAÅARILI: {len(new_data)} adet yeni politika maddesi RAG motoruna yÃ¼klendi.")
    print("ArtÄ±k test senaryolarÄ±nÄ± tekrar Ã§alÄ±ÅŸtÄ±rabilirsin!")

except FileNotFoundError:
    print("HATA: 'sirket_politikalari.json' dosyasÄ± bulunamadÄ±. LÃ¼tfen dataset oluÅŸturma kodunu Ã¶nce Ã§alÄ±ÅŸtÄ±rÄ±n.")